---
layout: post
title: "MMA 1st 2015 Cannot Be Run"
date: 2015-09-06 19:53:32 -0400
author: [superkojiman]
comments: true
categories: [mma]
---

### Solved by superkojiman

The MZ signature is invalid. Just replace the first 232 bytes of the binary with a valid MZ signature and save the file with a .exe extension. 

Here's the original corrupted MZ. Notice it says "Is this program can't be run on DOS?" instead of "This program cannot be run in DOS mode"

```
000000: 4d5a 9000 0300 0000 0400 0000 ffff 0000  MZ..............
0000010: b800 0000 0000 0000 4000 0000 0000 0000  ........@.......
0000020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
0000030: 0000 0000 0000 0000 0000 0000 0000 0000  ................
0000040: 0e1f ba0e 00b4 09cd 21b8 014c cd21 4973  ........!..L.!Is
0000050: 2074 6869 7320 7072 6f67 7261 6d20 6361   this program ca
0000060: 6e27 7420 6265 2072 756e 206f 6e20 444f  n't be run on DO
0000070: 533f 0d0a 0d0a 2424 2400 0000 0000 0000  S?....$$$.......
0000080: 8aac 02c4 cecd 6c97 cecd 6c97 cecd 6c97  ......l...l...l.
0000090: c7b5 ff97 cdcd 6c97 c7b5 f997 cfcd 6c97  ......l.......l.
00000a0: c7b5 ef97 dbcd 6c97 c7b5 e897 cccd 6c97  ......l.......l.
00000b0: e90b 1797 cccd 6c97 cecd 6d97 e7cd 6c97  ......l...m...l.
00000c0: c7b5 e597 cfcd 6c97 c7b5 fd97 cfcd 6c97  ......l.......l.
00000d0: 5269 6368 cecd 6c97 0000 0000 0000 0000  Rich..l.........
00000e0: 0000 0000 0000 0000 5045 0000 4c01 0500  ........PE..L...
```

After fixing it: 

```
0000000: 4d5a 9000 0300 0000 0400 0000 ffff 0000  MZ..............
0000010: b800 0000 0000 0000 4000 0000 0000 0000  ........@.......
0000020: 0000 0000 0000 0000 0000 0000 0000 0000  ................
0000030: 0000 0000 0000 0000 0000 0000 e800 0000  ................
0000040: 0e1f ba0e 00b4 09cd 21b8 014c cd21 5468  ........!..L.!Th
0000050: 6973 2070 726f 6772 616d 2063 616e 6e6f  is program canno
0000060: 7420 6265 2072 756e 2069 6e20 444f 5320  t be run in DOS
0000070: 6d6f 6465 2e0d 0d0a 2400 0000 0000 0000  mode....$.......
0000080: f3bc dd54 b7dd b307 b7dd b307 b7dd b307  ...T............
0000090: bea5 2007 b4dd b307 bea5 2607 b6dd b307  .. .......&.....
00000a0: bea5 3007 badd b307 bea5 3707 b5dd b307  ..0.......7.....
00000b0: 901b c807 b5dd b307 b7dd b207 a9dd b307  ................
00000c0: bea5 3907 b4dd b307 bea5 2107 b6dd b307  ..9.......!.....
00000d0: bea5 2207 b6dd b307 5269 6368 b7dd b307  ..".....Rich....
00000e0: 0000 0000 0000 0000 5045 0000 4c01 0500  ........PE..L...
```


Run it to get the flag: MMA{7a35hxb9q81fsg6}


